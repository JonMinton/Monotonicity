names(Summaries.Difs)[1] <- "method"
Summaries.Difs.Long <- melt(Summaries.Difs, id.var="method")
head(Summaries.Difs.Long)
?col_split
?mutate
Summaries.Difs.Long <- mutate(Summaries.Difs.Long, colsplit(variable, "_", c("var", "quantile")))
head(Summaries.Difs.Long)
?colsplit
Summaries.Difs.Long <- mutate(Summaries.Difs.Long, colsplit(Summaries.Difs.Long$variable, "_", c("var", "quantile")))
head(Summaries.Difs.Long)
head(colsplit(Summaries.Difs.Long$variable, "_", c("var", "quantile")))
Summaries.Difs.Long <- cbind(Summaries.Difs.Long, colsplit(Sum, "_", c("var", "quantile")))
Summaries.Difs.Long <- cbind(Summaries.Difs.Long, colsplit(Summaries.Difs.Long$variable, "_", c("var", "quantile")))
head(Summaries.Difs.Long)
Summaries.Difs.Long <- gdata::remove.vars(Summaries.Difs.Long, "variable")
head(Summaries.Difs.Long)
dlply(Summaries.Difs.Long, .(method, var), function(x) (mean(x))^0.5)
dlply(Summaries.Difs.Long, .(method, var), function(x) (mean(x$value))^0.5)
ddply(Summaries.Difs.Long, .(method, var), function(x) (mean(x$value))^0.5)
ddply(Summaries.Difs.Long, .(method, var), function(x) (rms=mean(x$value))^0.5)
?summarise
attach(Summaries.Difs.Long)
Summaries.Difs.Long <- Summaries.Difs.Long[order(var, method),]
detach(Summaries.Difs.Long)
Summaries.Difs.Long
Summaries.RMS <- ddply(Summaries.Difs.Long, .(method, var),function(x) (rms=mean(x$value))^0.5)
names(Summaries.RMS)
Summaries.RMS <- ddply(Summaries.Difs.Long, .(method, var),function(x) (rms=mean(x$value))^0.5)
attach(Summaries.RMS)
Summaries.RMS <- Summaries.RMS[order(var, method),]
detach(Summaries.RMS)
Summaries.RMS)
Summaries.RMS
?rename.vars
Summaries.RMS <- rename.vars(Summaries.RMS, from="V1", to="value")
g <- ggplot(Summaries.RMS)
g2 <- g + aes(x=value, y=method, group=var)
g3 <- g2 + geom_bar()
g3
?qplot
qplot(x=value, y=method, data=Summaries.RMS, facets = . ~ var)
qplot(x=value, y=method, data=Summaries.RMS, facets = . ~ var) + geom_hline()
qplot(x=value, y=method, data=Summaries.RMS, facets = . ~ var) + geom_line()
qplot(x=value, y=method, data=Summaries.RMS, facets = . ~ var)
qplot(x=value, y=method, data=Summaries.RMS, facets = . ~ var) + geom_bar()
qplot(x=value, y=method, data=Summaries.RMS, facets = . ~ var)
qplot(x=value, y=method, data=Summaries.RMS, facets = . ~ var, geom="line")
qplot(x=value, y=method, data=Summaries.RMS, facets = . ~ var, geom="bar")
qplot(x=method, y=value, data=Summaries.RMS, facets = . ~ var, geom="bar")
qplot(x=method, y=value, data=Summaries.RMS, facets = . ~ var, geom="bin")
qplot(x=value, y=method, data=Summaries.RMS, facets = . ~ var, geom="linerange")
qplot(x=method, y=value, data=Summaries.RMS, facets = var ~ ., geom="bar")
qplot(x=method, y=value, data=Summaries.RMS, facets = var ~ ., geom="bar") + coord_flip()
qplot(x=method, y=value, data=Summaries.RMS, facets = . ~  var, geom="bar") + coord_flip()
qplot(x=method, y=value, data=Summaries.RMS, facets = . ~  var) + coord_flip() + geom_bar(width=0.2)
qplot(x=method, y=value, data=Summaries.RMS, facets = . ~  var, geom="bar", ) + coord_flip() + geom_bar(width=0.2)
qplot(x=method, y=value, data=Summaries.RMS, facets = . ~  var, geom="bar" ) + coord_flip() + geom_bar(width=0.2)
qplot(x=method, y=value, data=Summaries.RMS, facets = . ~  var, geom="bar", width=0.3 ) + coord_flip()
?ggplot
qplot(aes(x=method, y=value), data=Summaries.RMS, facets = . ~  var) + coord_flip() + geom_bar(width=0.3)
qplot(aes(x=method, y=value), data=Summaries.RMS, facets = . ~  var) + coord_flip() + geom_bar()
qplot(aes(x=method, y=value), data=Summaries.RMS) + coord_flip() + geom_bar() + facets_wrap( ~ var)
qplot(aes(x=method, y=value), data=Summaries.RMS) + coord_flip() + geom_bar() + facet_wrap( ~ var)
qplot(x=method, y=value, data=Summaries.RMS, facets = . ~  var, geom="bar" ) + coord_flip()
qplot(x=method, y=value, data=Summaries.RMS, facets = . ~  var, geom="bar" ) + coord_flip()
g <- ggplot(data=Summaries.RMS)
g2 <- g + geom_bar(aes(x=method, group=value))
g2
g2 <- g + geom_bar(aes(x=value, group=method))
g2
g2 <- g + geom_bar(aes(y=value, group=method))
g2
g2 <- g + geom_bar(aes(x=value, y=method))
g2
g2 <- g + geom_bar(aes(x=value, group=method)) + facet_wrap(. ~ var)
g2
g2 <- g + geom_bar(aes(x=value, group=method)) + facet_wrap(var)
g2 <- g + geom_bar(aes(x=value, group=method)) + facet_wrap( ~ var)
g2
g2 <- g + geom_bar(aes(x=value, y=method)) + facet_wrap( ~ var)
g2
qplot(x=method, y=value, data=Summaries.RMS, facets = . ~  var, geom="bar" ) + coord_flip()
g2 <- g + geom_bar(aes(x=value, y=method, stat="bin")) + facet_wrap()
g <- ggplot(data=Summaries.RMS)
g2 <- g + geom_bar(aes(x=value, y=method, stat="bin")) + facet_wrap()
g2 <- g + geom_bar(aes(x=value, y=method), stat="bin")) + facet_wrap()
g2 <- g + geom_bar(aes(x=value, y=method), stat="bin") + facet_wrap()
g2 <- g + geom_bar(aes(x=value, y=method), stat="bin") + facet_wrap( ~ var)
g2
g2 <- g + geom_bar(aes(x=value, y=method), stat="identity") + facet_wrap( ~ var)
g2
g <- ggplot(data=Summaries.RMS)
g2 <- g + geom_bar(aes(x=value, group=method), stat="identity") + facet_wrap( ~ var)
g2
g2 <- g + geom_bar(aes(x=value, group=method), stat="identity") + facet_wrap(var)
qplot(x=method, y=value, data=Summaries.RMS, facets = . ~  var, geom="bar" ) + coord_flip()
qplot(x=method, y=value, data=Summaries.RMS, facets = . ~  var, geom="bar" ) + coord_flip() + geom_bar(width=0.5)
qplot(x=method, y=value, data=Summaries.RMS, facets = . ~  var, geom=geom_bar(width=0.5)) + coord_flip()
qplot(x=method, y=value, data=Summaries.RMS, facets = . ~  var, geom="bar") + coord_flip()
qplot(x=method, y=value, data=Summaries.RMS, facets = . ~  var, geom="bar", fill="red")+ coord_flip()
qplot(x=method, y=value, data=Summaries.RMS, facets = . ~  var, geom="bar", fill=red)+ coord_flip()
qplot(x=method, y=value, data=Summaries.RMS, facets = . ~  var, geom="bar", fill=col="red")+ coord_flip()
qplot(x=method, y=value, data=Summaries.RMS, facets = . ~  var, geom="bar", fill=col="red")+ coord_flip()
col <- "red"
qplot(x=method, y=value, data=Summaries.RMS, facets = . ~  var, geom="bar", fill=col="red")+ coord_flip()
col <- "red"
qplot(x=method, y=value, data=Summaries.RMS, facets = . ~  var, geom="bar", fill=col)+ coord_flip()
qplot(x=method, y=value, data=Summaries.RMS, facets = . ~  var, geom="bar", width=0.4)+ coord_flip()
qplot(x=method, y=value, data=Summaries.RMS, facets = . ~  var, geom="bar", size=0.4)+ coord_flip()
qplot(x=method, y=value, data=Summaries.RMS, facets = . ~  var, geom="bar", lwd=2)+ coord_flip()
qplot(x=method, y=value, data=Summaries.RMS, facets = . ~  var, geom="bar")+ coord_flip()
?geom_linerange
ggplot(data=Summaries.RMS, facets = . ~ var) + geom_linerange(x=method, ymax=value, ymin=0) + coord_flip)
ggplot(data=Summaries.RMS, facets = . ~ var) + geom_linerange(aes(x=method, ymax=value, ymin=0)) + coord_flip)
ggplot(data=Summaries.RMS, facets = . ~ var) + geom_linerange(aes(x=method, ymax=value, ymin=0)) + coord_flip())
ggplot(data=Summaries.RMS, facets = . ~ var) + geom_linerange(aes(x=method, ymax=value, ymin=0)) + coord_flip()
g1 <- ggplot(data=Summaries.RMS, facets = . ~ var) + geom_linerange(aes(x=method, ymax=value, ymin=0)) + coord_flip()
g1 <- ggplot(data=Summaries.RMS) + geom_linerange(aes(x=method, ymax=value, ymin=0)) + coord_flip()
g2 <- g1 + facet_wrap( . ~ var)
g2
g2 <- g1 + facet_wrap(  ~ var)
g2
g1 <- ggplot(data=Summaries.RMS) + geom_bar(aes(x=method, ymax=value, ymin=0)) + coord_flip()
g2 <- g1 + facet_wrap(  ~ var)
g2
g1 <- ggplot(data=Summaries.RMS) + geom_linerange(aes(x=method, ymax=value, ymin=0), size=2) + coord_flip()
g2 <- g1 + facet_wrap(  ~ var)
g2
g1 <- ggplot(data=Summaries.RMS) + geom_linerange(aes(x=method, ymax=value, ymin=0), size=1.2) + coord_flip()
g2 <- g1 + facet_wrap(  ~ var)
g2
names(Summaries.RMS)
g1 <- ggplot(data=Summaries.RMS) + geom_linerange(aes(x=method, ymax=value, ymin=0), size=1.2) + coord_flip()
g2 <- g1 + facet_wrap(  ~ var) + scale_x_reverse()
g2
g2
g1 <- ggplot(data=Summaries.RMS) + geom_linerange(aes(x=method, ymax=value, ymin=0), size=1.2) + coord_flip() + scale_x_reverse()
g2 <- g1 + facet_wrap(  ~ var)
g2
g1 <- ggplot(data=Summaries.RMS) + geom_linerange(aes(x=rev(method), ymax=value, ymin=0), size=1.2) + coord_flip()
g2 <- g1 + facet_wrap(  ~ var)
g2
levels(Summaries.RMS$method)
factor(Summaries.RMS$method) <- factor(Summaries.RMS$method,
levels=rev(levels(Summaries.RMS$method))
)
Summaries.RMS$method <- factor(Summaries.RMS$method,
levels=rev(levels(Summaries.RMS$method))
)
qplot(x=method, y=value, data=Summaries.RMS, facets = . ~  var, geom="bar")+ coord_flip()
g1 <- ggplot(data=Summaries.RMS) + geom_linerange(aes(x=method, ymax=value, ymin=0), size=1.2) + coord_flip()
g2 <- g1 + facet_wrap(  ~ var)
g2
source("scripts/LoadPackages.R")
# 29/5/2014
rm (list=ls())
# Stages:
# Load prerequisites
source("scripts/LoadPackages.R")
rm (list=ls())
# Stages:
# Load prerequisites
source("scripts/LoadPackages.R")
RequiredPackages(
c(
"MASS",
"xlsx",
"ggplot2",
"reshape",
"gdata"
)
)
RequiredPackages(
c(
"MASS",
"xlsx",
"ggplot2",
"reshape",
"gdata",
"rmarkdown"
)
)
# New main script for Monotonicity analysis generation
# 29/5/2014
rm (list=ls())
# Stages:
# Load prerequisites
source("scripts/LoadPackages.R")
RequiredPackages(
c(
"MASS",
"xlsx",
"ggplot2",
"reshape",
"gdata",
"rmarkdown"
)
)
install.packages("RMark")
devtools::install_github("rstudio/rmarkdown")
RequiredPackages(
c(
"MASS",
"xlsx",
"ggplot2",
"reshape",
"gdata",
"devtools"
)
)
str(installed.packages())
installed.packages()[,"Package"]
devtools::install_github("rstudio/rmarkdown")
version()
Sys.info()
sessionInfo()
devtools::install_github("rstudio/rmarkdown")
rm (list=ls())
# Stages:
# Load prerequisites
source("scripts/LoadPackages.R")
RequiredPackages(
c(
"MASS",
"xlsx",
"ggplot2",
"reshape",
"gdata",
"devtools"
)
)
## The
## devtools::install_github("rstudio/rmarkdown")
# Load functions
source("scripts/functions.r")
n.psa <- 100000
source("Scripts/manage_data.r")
Summaries.MeanSD <- cast(
Data_Long,
method ~ variable,
function(x) c(mean=mean(x), sd=sd(x))
)
Summaries.Quantiles <- cast(
Data_Long,
method ~ variable,
quantile,
seq(from=0.025, to=0.975, by=0.05)
)
Summaries.Difs <- cbind(
Summaries.Quantiles[-1,1],
adply(Summaries.Quantiles[-1,-1],1, function(x) ((x - Summaries.Quantiles[1,-1])^2))
)
RequiredPackages(
c(
"MASS",
"xlsx",
"ggplot2",
"reshape",
"gdata",
"devtools",
"plyr"
)
)
Summaries.Difs <- cbind(
Summaries.Quantiles[-1,1],
adply(Summaries.Quantiles[-1,-1],1, function(x) ((x - Summaries.Quantiles[1,-1])^2))
)
Summaries.Difs
)
names(Summaries.Difs)[1] <- "method"
Summaries.Difs.Long <- melt(Summaries.Difs, id.var="method")
Summaries.Difs.Long <- cbind(Summaries.Difs.Long, colsplit(Summaries.Difs.Long$variable, "_", c("var", "quantile")))
Summaries.Difs.Long <- gdata::remove.vars(Summaries.Difs.Long, "variable")
Summaries.RMS <- ddply(Summaries.Difs.Long, .(method, var),function(x) (rms=mean(x$value))^0.5)
Summaries.RMS <- arrange(Summarise.RMS, var, method)
Summaries.RMS <- ddply(Summaries.Difs.Long, .(method, var),function(x) (rms=mean(x$value))^0.5)
Summaries.RMS <- arrange(Summarise.RMS, var, method)
Summaries.RMS <- arrange(Summaries.RMS, var, method)
head(Summaries.RMS)
Summaries.RMS <- rename.vars(Summaries.RMS, from="V1", to="value")
Summaries.RMS$method <- factor(Summaries.RMS$method,
levels=rev(levels(Summaries.RMS$method))
)
qplot(x=method, y=value, data=Summaries.RMS, facets = . ~  var, geom="bar")+ coord_flip()
?qplot
require(ggplot2)
install.packages(ggplot2)
install.packages("ggplot2")
qplot(x=method, y=value, data=Summaries.RMS, facets = . ~  var, geom="bar")+ coord_flip()
require(ggplot2)
qplot(x=method, y=value, data=Summaries.RMS, facets = . ~  var, geom="bar")+ coord_flip()
g1 <- ggplot(data=Summaries.RMS) + geom_linerange(aes(x=method, ymax=value, ymin=0), size=1.2) + coord_flip()
g2 <- g1 + facet_wrap(  ~ var)
g2
install.packages("labeling")
g1 <- ggplot(data=Summaries.RMS) + geom_linerange(aes(x=method, ymax=value, ymin=0), size=1.2) + coord_flip()
g2 <- g1 + facet_wrap(  ~ var)
g2
ls()
Data.2D
g1 <- ggplot(data=Summaries.RMS) + geom_point(aes(x=method)) + coord_flip()
g2 <- g1 + facet_wrap(  ~ var)
g2
g1 <- ggplot(data=Summaries.RMS) + aes(x=method) + geom_point() + coord_flip()
g2 <- g1 + facet_wrap(  ~ var)
g2
g1 <- ggplot(data=Summaries.RMS) + aes(x=method) + geom_point() + coord_flip()
g1
?aes
ggplot(data=Summaries.RMS) + aes(x=method) + geom_point()
ggplot(data=Summaries.RMS) + aes(x=method)
?geom_point
ggplot(data=Summaries.RMS) + aes(x=method, y=value) + geom_point()
g2 <- g1 + facet_wrap(  ~ var)
ggplot(data=Summaries.RMS) + aes(y=method, x=value) + geom_point()
g2 <- g1 + facet_wrap(  ~ var)
g2
g1 <- ggplot(data=Summaries.RMS) + aes(y=method, x=value) + geom_point()
g2 <- g1 + facet_wrap(  ~ var)
g2
?lab
?label
g1 <- ggplot(data=Summaries.RMS) + aes(y=method, x=value) + geom_point()
g2 <- g1 + facet_wrap(  ~ var) + labs (x="Root mean squared error", y="Method")
g2
g1 <- ggplot(data=Summaries.RMS) + aes(y=method, x=value) + geom_point(size=1.2)
g2 <- g1 + facet_wrap(  ~ var) + labs (x="Root mean squared error", y="Method")
g2
g1 <- ggplot(data=Summaries.RMS) + aes(y=method, x=value) + geom_point(size=1.5)
g2 <- g1 + facet_wrap(  ~ var) + labs (x="Root mean squared error", y="Method")
g2
g1 <- ggplot(data=Summaries.RMS) + aes(y=method, x=value) + geom_point(size=4)
g2 <- g1 + facet_wrap(  ~ var) + labs (x="Root mean squared error", y="Method")
g2
g1 <- ggplot(data=Summaries.RMS) + aes(y=method, x=value) + geom_point(size=3)
g2 <- g1 + facet_wrap(  ~ var) + labs (x="Root mean squared error", y="Method")
g2
head(Summaries.RMS)
levels(Summaries.RMS$var)
levels(Summaries.RMS$var) <- c("Difference", "Higher", "Lower")
?ordered
levels(Summaries.RMS$var) <- c("Difference", "Higher", "Lower")
g1 <- ggplot(data=Summaries.RMS) + aes(y=method, x=value) + geom_point(size=3)
g2 <- g1 + facet_wrap(  ~ var) + labs (x="Root mean squared error", y="Method")
g2
ggplot(data= subset(C1, method!="Bootstrapped"), aes(x=method, y= U1_X50.,
ymin=U1_X2.5., ymax=U1_X97.5.)) +
geom_pointrange(size=1.4) + geom_hline(aes(yintercept=subset(C1, method=="Bootstrapped")$U1_X2.5.), lty="dashed") +
xlab("Method\n") + ylab("\n Quantile Range") +
coord_flip() + geom_hline(aes(yintercept=subset(C1, method=="Bootstrapped")$U1_X97.5.), lty="dashed") +
geom_hline(aes(yintercept=subset(C1, method=="Bootstrapped")$U1_X50.))
g <- ggplot(data=Data_Wide, aes(x=U1, y=U2))
g2 <- g + geom_point() + facet_wrap(~ method, nrow=3)
g3 <- g2 + geom_abline(intercept=0, slope=1, colour="red", lty="dashed", size=1.1)
g4 <- g3 + coord_fixed(xlim=c(0.4, 0.7), ylim=c(0.4, 0.7))
g5 <- g4 + xlab("Better health state") + ylab("Worse health state")
print(g5)
g <- ggplot(subset(Data_Wide, method!="Bootstrapped"), aes(x=U1)) + geom_density(fill="grey")
g2 <- g + facet_wrap("method", nrow=4)
g3 <- g2 + geom_density(aes(x=subset(Data_Wide, method=="Bootstrapped")$U1), col="blue", width=1.1, lty="dashed")
g4 <- g3 + xlab("Distribution of estimates of better health state")
print(g4)
tiff("figures/fig_01.tiff", 1000,1000)
g <- ggplot(data=Data_Wide, aes(x=U1, y=U2))
g2 <- g + geom_point() + facet_wrap(~ method, nrow=3)
g3 <- g2 + geom_abline(intercept=0, slope=1, colour="red", lty="dashed", size=1.1)
g4 <- g3 + coord_fixed(xlim=c(0.4, 0.7), ylim=c(0.4, 0.7))
g5 <- g4 + xlab("Higher parameter") + ylab("Lower parameter")
print(g5)
dev.off()
tiff("figures/fig_02.tiff", 1200, 800)
g <- ggplot(subset(Data_Wide, method!="Bootstrapped"), aes(x=U1)) + geom_density(fill="grey")
g2 <- g + facet_wrap("method", nrow=4)
g3 <- g2 + geom_density(aes(x=subset(Data_Wide, method=="Bootstrapped")$U1), col="blue", width=1.1, lty="dashed")
g4 <- g3 + xlab("Distribution of estimates for higher parameter")
print(g4)
dev.off()
# U2 : worse health state
tiff("Figures/Fig_03.tiff", 1200, 800)
g <- ggplot(subset(Data_Wide, method!="Bootstrapped"), aes(x=U2)) + geom_density(fill="grey")
g2 <- g + facet_wrap("method", nrow=4)
g3 <- g2 + geom_density(aes(x=subset(Data_Wide, method=="Bootstrapped")$U2), col="blue", width=1.2, lty="dashed")
g4 <- g3 + xlab("Distribution of estimates for lower parameter")
print(g4)
dev.off()
g <- ggplot(subset(Data_Wide, method!="Bootstrapped"), aes(x=difference)) + geom_density(fill="grey")
g2 <- g + facet_wrap("method", nrow=4)
g3 <- g2 + geom_density(
aes(x=subset(Data_Wide, method=="Bootstrapped")$difference),
col="blue", width=1.2, lty="dashed",
trim=T
)
g4 <- g3 + xlab("Distribution of differences in paired estimates")
g5 <- g4 + coord_cartesian(ylim=c(0,100))
g6 <- g5 + geom_vline(mapping=aes(x=0), colour="red", linetype="dashed")
print(g6)
g <- ggplot(subset(Data_Wide, method!="Bootstrapped"), aes(x=difference)) + geom_density(fill="grey")
g2 <- g + facet_wrap("method", nrow=4)
g3 <- g2 + geom_density(
aes(x=subset(Data_Wide, method=="Bootstrapped")$difference),
col="blue", width=1.2, lty="dashed",
trim=T
)
g4 <- g3 + xlab("Distribution of differences in paired estimates")
g5 <- g4 + coord_cartesian(ylim=c(0,100))
g6 <- g5 + geom_vline(mapping=aes(x=0), colour="red")
print(g6)
tiff("Figures/Fig_04.tiff", 1200, 800)
g <- ggplot(subset(Data_Wide, method!="Bootstrapped"), aes(x=difference)) + geom_density(fill="grey")
g2 <- g + facet_wrap("method", nrow=4)
g3 <- g2 + geom_density(
aes(x=subset(Data_Wide, method=="Bootstrapped")$difference),
col="blue", width=1.2, lty="dashed",
trim=T
)
g4 <- g3 + xlab("Distribution of differences in paired estimates")
g5 <- g4 + coord_cartesian(ylim=c(0,100))
g6 <- g5 + geom_vline(mapping=aes(x=0), colour="red")
print(g6)
dev.off()
ggplot(data= subset(C1, method!="Bootstrapped"), aes(x=method, y= U1_X50.,
ymin=U1_X2.5., ymax=U1_X97.5.)) +
geom_pointrange(size=1.4) + geom_hline(aes(yintercept=subset(C1, method=="Bootstrapped")$U1_X2.5.), lty="dashed") +
xlab("Method\n") + ylab("\n Quantile Range") +
coord_flip() + geom_hline(aes(yintercept=subset(C1, method=="Bootstrapped")$U1_X97.5.), lty="dashed") +
geom_hline(aes(yintercept=subset(C1, method=="Bootstrapped")$U1_X50.))
tiff("figures/fig_05.tiff", 1200, 800)
levels(Summaries.RMS$var) <- c("Difference", "Higher", "Lower")
g1 <- ggplot(data=Summaries.RMS) + aes(y=method, x=value) + geom_point(size=3)
g2 <- g1 + facet_wrap(  ~ var) + labs (x="Root mean squared error", y="Method")
print(g2)
dev.off()
tiff("figures/fig_01.tiff", 1000,1000)
g <- ggplot(data=Data_Wide, aes(x=U1, y=U2))
g2 <- g + geom_point() + facet_wrap(~ method, nrow=3)
g3 <- g2 + geom_abline(intercept=0, slope=1, colour="red", lty="dashed", size=1.1)
g4 <- g3 + coord_fixed(xlim=c(0.4, 0.7), ylim=c(0.4, 0.7))
g5 <- g4 + xlab("Higher parameter") + ylab("Lower parameter")
print(g5)
dev.off()
tiff("figures/fig_02.tiff", 1200, 800)
g <- ggplot(subset(Data_Wide, method!="Bootstrapped"), aes(x=U1)) + geom_density(fill="grey")
g2 <- g + facet_wrap("method", nrow=4)
g3 <- g2 + geom_density(aes(x=subset(Data_Wide, method=="Bootstrapped")$U1), col="blue", width=1.1, lty="dashed")
g4 <- g3 + xlab("Distribution of estimates for higher parameter")
print(g4)
dev.off()
tiff("figures/fig_03.tiff", 1200, 800)
g <- ggplot(subset(Data_Wide, method!="Bootstrapped"), aes(x=U2)) + geom_density(fill="grey")
g2 <- g + facet_wrap("method", nrow=4)
g3 <- g2 + geom_density(aes(x=subset(Data_Wide, method=="Bootstrapped")$U2), col="blue", width=1.2, lty="dashed")
g4 <- g3 + xlab("Distribution of estimates for lower parameter")
print(g4)
dev.off()
tiff("figures/fig_04.tiff", 1200, 800)
g <- ggplot(subset(Data_Wide, method!="Bootstrapped"), aes(x=difference)) + geom_density(fill="grey")
g2 <- g + facet_wrap("method", nrow=4)
g3 <- g2 + geom_density(
aes(x=subset(Data_Wide, method=="Bootstrapped")$difference),
col="blue", width=1.2, lty="dashed",
trim=T
)
g4 <- g3 + xlab("Distribution of differences in paired estimates")
g5 <- g4 + coord_cartesian(ylim=c(0,100))
g6 <- g5 + geom_vline(mapping=aes(x=0), colour="red")
print(g6)
dev.off()
tiff("figures/fig_05.tiff", 1200, 800)
levels(Summaries.RMS$var) <- c("Difference", "Higher", "Lower")
g1 <- ggplot(data=Summaries.RMS) + aes(y=method, x=value) + geom_point(size=3)
g2 <- g1 + facet_wrap(  ~ var) + labs (x="Root mean squared error", y="Method")
print(g2)
dev.off()
tiff("figures/fig_01.tiff", 1100,1100)
g <- ggplot(data=Data_Wide, aes(x=U1, y=U2))
g2 <- g + geom_point() + facet_wrap(~ method, nrow=3)
g3 <- g2 + geom_abline(intercept=0, slope=1, colour="red", lty="dashed", size=1.1)
g4 <- g3 + coord_fixed(xlim=c(0.4, 0.7), ylim=c(0.4, 0.7))
g5 <- g4 + xlab("Higher parameter") + ylab("Lower parameter")
print(g5)
dev.off()
g <- ggplot(data=Data_Wide, aes(x=U1, y=U2))
g2 <- g + geom_point() + facet_wrap(~ method, nrow=3)
g3 <- g2 + geom_abline(intercept=0, slope=1, colour="red", lty="dashed", size=1.1)
g5 <- g4 + xlab("Higher parameter") + ylab("Lower parameter")
g4 <- g3 + coord_fixed(xlim=c(0.4, 0.7), ylim=c(0.4, 0.7))
g6 <- g5 + theme(text=14)
print(g6)
g6 <- g5 + theme(text=element_text(14))
print(g6)
g <- ggplot(data=Data_Wide, aes(x=U1, y=U2))
g2 <- g + geom_point() + facet_wrap(~ method, nrow=3)
g3 <- g2 + geom_abline(intercept=0, slope=1, colour="red", lty="dashed", size=1.1)
g4 <- g3 + coord_fixed(xlim=c(0.4, 0.7), ylim=c(0.4, 0.7))
g5 <- g4 + xlab("Higher parameter") + ylab("Lower parameter")
g6 <- g5 + theme(text=element_text(size=rel(1.2)))
print(g6)
g6 <- g5 + theme(text=element_text(size=1.2))
print(g6)
g6 <- g5 + theme(text=element_text(size=14))
print(g6)
g6 <- g5 + theme(text=element_text(size=16))
print(g6)
tiff("figures/fig_01.tiff", 1100,1100)
g <- ggplot(data=Data_Wide, aes(x=U1, y=U2))
g2 <- g + geom_point() + facet_wrap(~ method, nrow=3)
g3 <- g2 + geom_abline(intercept=0, slope=1, colour="red", lty="dashed", size=1.1)
g4 <- g3 + coord_fixed(xlim=c(0.4, 0.7), ylim=c(0.4, 0.7))
g5 <- g4 + xlab("Higher parameter") + ylab("Lower parameter")
g6 <- g5 + theme(text=element_text(size=16))
print(g6)
dev.off()
